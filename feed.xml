<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.0.0">Jekyll</generator><link href="https://yogabonito.github.io/blog/feed.xml" rel="self" type="application/atom+xml" /><link href="https://yogabonito.github.io/blog/" rel="alternate" type="text/html" /><updated>2020-05-14T19:04:51-05:00</updated><id>https://yogabonito.github.io/blog/feed.xml</id><title type="html">yogaBLOGito</title><subtitle>Blog for my research publications</subtitle><entry><title type="html">The Relation between the SEIR Epidemic Model and Hawkes Processes</title><link href="https://yogabonito.github.io/blog/epidemic%20models/2020/04/24/seir-hawkes.html" rel="alternate" type="text/html" title="The Relation between the SEIR Epidemic Model and Hawkes Processes" /><published>2020-04-24T00:00:00-05:00</published><updated>2020-04-24T00:00:00-05:00</updated><id>https://yogabonito.github.io/blog/epidemic%20models/2020/04/24/seir-hawkes</id><content type="html" xml:base="https://yogabonito.github.io/blog/epidemic%20models/2020/04/24/seir-hawkes.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-04-24-seir-hawkes.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Introduction&quot;&gt;Introduction&lt;a class=&quot;anchor-link&quot; href=&quot;#Introduction&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Since their introduction in the 1970s, Hawkes processes have been successfully applied in many different fields, including seismology, finance, and information science. Alan G. Hawkes also considered his class of stochastic processes &quot;a possible epidemic model in large populations&quot;&lt;sup id=&quot;fnref-1&quot; class=&quot;footnote-ref&quot;&gt;&lt;a href=&quot;#fn-1&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;However, a model assuming an infinitely large population is often not suitable when modeling the spread of diseases. That is why many researchers preferred compartmental epidemic models (such as the SIR or SEIR model) to Hawkes processes.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Only recently, it has been shown that there is a link between Hawkes-like processes and the SIR compartmental model.&lt;sup id=&quot;fnref-2&quot; class=&quot;footnote-ref&quot;&gt;&lt;a href=&quot;#fn-2&quot;&gt;2&lt;/a&gt;&lt;/sup&gt; As Rizoiu et al. put it, &quot;[t]his is significant, as it
indicates that tools developed for one approach can be applied to the other.&quot; However, this link is restricted to the SIR compartmental model. As this model lacks the capability to model a latent period, many researchers turn to more complex models such as the SEIR model and variants thereof. This is especially true for diffusion analyses in the current Covid-19 crisis.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;We have discovered a link between the SEIR model and Hawkes-like processes.&lt;sup id=&quot;fnref-3&quot; class=&quot;footnote-ref&quot;&gt;&lt;a href=&quot;#fn-3&quot;&gt;3&lt;/a&gt;&lt;/sup&gt; In this blog post, we explain it briefly and give an overview of all the models mentioned so far.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;But before we dive into the theory, let's get a feel of the models we will talk about. The following plot shows four subplots, each containing the total number of infections (y-axis) that occured until a certain day (x-axis) in a population of 10 thousand people using one specific simulation model. When you hover over the bars, you will notice that many infection counts are not integers; that is because they are calculated as the mean of many simulations. Experiment with the sliders below the plot and see how they affect the spread of a disease.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;

&lt;div id=&quot;altair-viz-7ba8f47b3ebf43d884e9beeb63885233&quot;&gt;&lt;/div&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== &quot;altair-viz-7ba8f47b3ebf43d884e9beeb63885233&quot;) {
      outputDiv = document.getElementById(&quot;altair-viz-7ba8f47b3ebf43d884e9beeb63885233&quot;);
    }
    const paths = {
      &quot;vega&quot;: &quot;https://cdn.jsdelivr.net/npm//vega@5?noext&quot;,
      &quot;vega-lib&quot;: &quot;https://cdn.jsdelivr.net/npm//vega-lib?noext&quot;,
      &quot;vega-lite&quot;: &quot;https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext&quot;,
      &quot;vega-embed&quot;: &quot;https://cdn.jsdelivr.net/npm//vega-embed@6?noext&quot;,
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () =&gt; resolve(paths[lib]);
        s.onerror = () =&gt; reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName(&quot;head&quot;)[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `&lt;div class=&quot;error&quot; style=&quot;color:red;&quot;&gt;${err}&lt;/div&gt;`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err =&gt; showError(`Javascript Error: ${err.message}&lt;br&gt;This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === &quot;function&quot; &amp;&amp; define.amd) {
      requirejs.config({paths});
      require([&quot;vega-embed&quot;], displayChart, err =&gt; showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === &quot;function&quot;) {
      displayChart(vegaEmbed);
    } else {
      loadScript(&quot;vega&quot;)
        .then(() =&gt; loadScript(&quot;vega-lite&quot;))
        .then(() =&gt; loadScript(&quot;vega-embed&quot;))
        .catch(showError)
        .then(() =&gt; displayChart(vegaEmbed));
    }
  })({&quot;config&quot;: {&quot;view&quot;: {&quot;continuousWidth&quot;: 400, &quot;continuousHeight&quot;: 300}}, &quot;vconcat&quot;: [{&quot;hconcat&quot;: [{&quot;data&quot;: {&quot;url&quot;: &quot;https://raw.githubusercontent.com/yogabonito/blog/master/_notebooks/fig/cumulative_infections/sir.json&quot;}, &quot;mark&quot;: &quot;bar&quot;, &quot;encoding&quot;: {&quot;tooltip&quot;: [{&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;day&quot;}, {&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;cumulative infections&quot;}], &quot;x&quot;: {&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;day&quot;, &quot;scale&quot;: {&quot;domain&quot;: [1, 46]}}, &quot;y&quot;: {&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;cumulative infections&quot;, &quot;scale&quot;: {&quot;domain&quot;: [0, 10000]}}}, &quot;selection&quot;: {&quot;parameter_gamma&quot;: {&quot;type&quot;: &quot;single&quot;, &quot;fields&quot;: [&quot;gamma&quot;], &quot;bind&quot;: {&quot;gamma&quot;: {&quot;input&quot;: &quot;range&quot;, &quot;max&quot;: 1, &quot;min&quot;: 0.1, &quot;name&quot;: &quot;recovery rate \u03b3 &quot;, &quot;step&quot;: 0.1}}, &quot;init&quot;: {&quot;gamma&quot;: 0.1}}, &quot;parameter_beta&quot;: {&quot;type&quot;: &quot;single&quot;, &quot;fields&quot;: [&quot;beta&quot;], &quot;bind&quot;: {&quot;beta&quot;: {&quot;input&quot;: &quot;range&quot;, &quot;max&quot;: 1.4, &quot;min&quot;: 0.4, &quot;name&quot;: &quot;infection rate \u03b2 &quot;, &quot;step&quot;: 0.2}}, &quot;init&quot;: {&quot;beta&quot;: 1}}}, &quot;title&quot;: &quot;SIR&quot;, &quot;transform&quot;: [{&quot;filter&quot;: {&quot;selection&quot;: &quot;parameter_gamma&quot;}}, {&quot;filter&quot;: {&quot;selection&quot;: &quot;parameter_beta&quot;}}]}, {&quot;data&quot;: {&quot;url&quot;: &quot;https://raw.githubusercontent.com/yogabonito/blog/master/_notebooks/fig/cumulative_infections/seir.json&quot;}, &quot;mark&quot;: &quot;bar&quot;, &quot;encoding&quot;: {&quot;tooltip&quot;: [{&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;day&quot;}, {&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;cumulative infections&quot;}], &quot;x&quot;: {&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;day&quot;, &quot;scale&quot;: {&quot;domain&quot;: [1, 46]}}, &quot;y&quot;: {&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;cumulative infections&quot;, &quot;scale&quot;: {&quot;domain&quot;: [0, 10000]}}}, &quot;selection&quot;: {&quot;parameter_gamma&quot;: {&quot;type&quot;: &quot;single&quot;, &quot;fields&quot;: [&quot;gamma&quot;], &quot;bind&quot;: {&quot;gamma&quot;: {&quot;input&quot;: &quot;range&quot;, &quot;max&quot;: 1, &quot;min&quot;: 0.1, &quot;name&quot;: &quot;recovery rate \u03b3 &quot;, &quot;step&quot;: 0.1}}, &quot;init&quot;: {&quot;gamma&quot;: 0.1}}, &quot;parameter_beta&quot;: {&quot;type&quot;: &quot;single&quot;, &quot;fields&quot;: [&quot;beta&quot;], &quot;bind&quot;: {&quot;beta&quot;: {&quot;input&quot;: &quot;range&quot;, &quot;max&quot;: 1.4, &quot;min&quot;: 0.4, &quot;name&quot;: &quot;infection rate \u03b2 &quot;, &quot;step&quot;: 0.2}}, &quot;init&quot;: {&quot;beta&quot;: 1}}, &quot;parameter_sigma&quot;: {&quot;type&quot;: &quot;single&quot;, &quot;fields&quot;: [&quot;sigma&quot;], &quot;bind&quot;: {&quot;sigma&quot;: {&quot;input&quot;: &quot;range&quot;, &quot;max&quot;: 1, &quot;min&quot;: 0.1, &quot;name&quot;: &quot;incubation rate \u03c3 &quot;, &quot;step&quot;: 0.1}}, &quot;init&quot;: {&quot;sigma&quot;: 0.3}}}, &quot;title&quot;: &quot;SEIR&quot;, &quot;transform&quot;: [{&quot;filter&quot;: {&quot;selection&quot;: &quot;parameter_gamma&quot;}}, {&quot;filter&quot;: {&quot;selection&quot;: &quot;parameter_beta&quot;}}, {&quot;filter&quot;: {&quot;selection&quot;: &quot;parameter_sigma&quot;}}]}]}, {&quot;hconcat&quot;: [{&quot;data&quot;: {&quot;url&quot;: &quot;https://raw.githubusercontent.com/yogabonito/blog/master/_notebooks/fig/cumulative_infections/exp_hawkesn.json&quot;}, &quot;mark&quot;: &quot;bar&quot;, &quot;encoding&quot;: {&quot;tooltip&quot;: [{&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;day&quot;}, {&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;cumulative infections&quot;}], &quot;x&quot;: {&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;day&quot;, &quot;scale&quot;: {&quot;domain&quot;: [1, 46]}}, &quot;y&quot;: {&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;cumulative infections&quot;, &quot;scale&quot;: {&quot;domain&quot;: [0, 10000]}}}, &quot;selection&quot;: {&quot;parameter_gamma&quot;: {&quot;type&quot;: &quot;single&quot;, &quot;fields&quot;: [&quot;gamma&quot;], &quot;bind&quot;: {&quot;gamma&quot;: {&quot;input&quot;: &quot;range&quot;, &quot;max&quot;: 1, &quot;min&quot;: 0.1, &quot;name&quot;: &quot;recovery rate \u03b3 &quot;, &quot;step&quot;: 0.1}}, &quot;init&quot;: {&quot;gamma&quot;: 0.1}}, &quot;parameter_beta&quot;: {&quot;type&quot;: &quot;single&quot;, &quot;fields&quot;: [&quot;beta&quot;], &quot;bind&quot;: {&quot;beta&quot;: {&quot;input&quot;: &quot;range&quot;, &quot;max&quot;: 1.4, &quot;min&quot;: 0.4, &quot;name&quot;: &quot;infection rate \u03b2 &quot;, &quot;step&quot;: 0.2}}, &quot;init&quot;: {&quot;beta&quot;: 1}}}, &quot;title&quot;: &quot;HawkesN process with exponential kernel&quot;, &quot;transform&quot;: [{&quot;filter&quot;: {&quot;selection&quot;: &quot;parameter_gamma&quot;}}, {&quot;filter&quot;: {&quot;selection&quot;: &quot;parameter_beta&quot;}}]}, {&quot;data&quot;: {&quot;url&quot;: &quot;https://raw.githubusercontent.com/yogabonito/blog/master/_notebooks/fig/cumulative_infections/hypoexp_and_erlang_hawkesn.json&quot;}, &quot;mark&quot;: &quot;bar&quot;, &quot;encoding&quot;: {&quot;tooltip&quot;: [{&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;day&quot;}, {&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;cumulative infections&quot;}], &quot;x&quot;: {&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;day&quot;, &quot;scale&quot;: {&quot;domain&quot;: [1, 46]}}, &quot;y&quot;: {&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;cumulative infections&quot;, &quot;scale&quot;: {&quot;domain&quot;: [0, 10000]}}}, &quot;selection&quot;: {&quot;parameter_gamma&quot;: {&quot;type&quot;: &quot;single&quot;, &quot;fields&quot;: [&quot;gamma&quot;], &quot;bind&quot;: {&quot;gamma&quot;: {&quot;input&quot;: &quot;range&quot;, &quot;max&quot;: 1, &quot;min&quot;: 0.1, &quot;name&quot;: &quot;recovery rate \u03b3 &quot;, &quot;step&quot;: 0.1}}, &quot;init&quot;: {&quot;gamma&quot;: 0.1}}, &quot;parameter_beta&quot;: {&quot;type&quot;: &quot;single&quot;, &quot;fields&quot;: [&quot;beta&quot;], &quot;bind&quot;: {&quot;beta&quot;: {&quot;input&quot;: &quot;range&quot;, &quot;max&quot;: 1.4, &quot;min&quot;: 0.4, &quot;name&quot;: &quot;infection rate \u03b2 &quot;, &quot;step&quot;: 0.2}}, &quot;init&quot;: {&quot;beta&quot;: 1}}, &quot;parameter_sigma&quot;: {&quot;type&quot;: &quot;single&quot;, &quot;fields&quot;: [&quot;sigma&quot;], &quot;bind&quot;: {&quot;sigma&quot;: {&quot;input&quot;: &quot;range&quot;, &quot;max&quot;: 1, &quot;min&quot;: 0.1, &quot;name&quot;: &quot;incubation rate \u03c3 &quot;, &quot;step&quot;: 0.1}}, &quot;init&quot;: {&quot;sigma&quot;: 0.3}}}, &quot;title&quot;: &quot;HawkesN process with hypoexponential/Erlang kernel&quot;, &quot;transform&quot;: [{&quot;filter&quot;: {&quot;selection&quot;: &quot;parameter_gamma&quot;}}, {&quot;filter&quot;: {&quot;selection&quot;: &quot;parameter_beta&quot;}}, {&quot;filter&quot;: {&quot;selection&quot;: &quot;parameter_sigma&quot;}}]}]}], &quot;$schema&quot;: &quot;https://vega.github.io/schema/vega-lite/v4.8.1.json&quot;}, {&quot;mode&quot;: &quot;vega-lite&quot;});
&lt;/script&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Comparing the subplots, we notice three things:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;div class=&quot;flash&quot;&gt;
    &lt;svg class=&quot;octicon octicon-info&quot; viewBox=&quot;0 0 14 16&quot; version=&quot;1.1&quot; width=&quot;14&quot; height=&quot;16&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M6.3 5.69a.942.942 0 01-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 01-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;
    &lt;strong&gt;Note: &lt;/strong&gt;The two subplots on the left look similar. This is a consequence of the finding of Rizoiu et al. that we mentioned above: There is a link between the SIR model and Hawkes-like processes.
&lt;/div&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;div class=&quot;flash&quot;&gt;
    &lt;svg class=&quot;octicon octicon-info octicon octicon-info&quot; viewBox=&quot;0 0 14 16&quot; version=&quot;1.1&quot; width=&quot;14&quot; height=&quot;16&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M6.3 5.69a.942.942 0 01-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 01-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;
    &lt;strong&gt;Note: &lt;/strong&gt;The two subplots on the right look similar. This is a consequence of our finding: There is a link between the SEIR model and Hawkes-like processes.
&lt;/div&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;div class=&quot;flash flash-warn&quot;&gt;
    &lt;svg class=&quot;octicon octicon-zap&quot; viewBox=&quot;0 0 10 16&quot; version=&quot;1.1&quot; width=&quot;10&quot; height=&quot;16&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M10 7H6l3-7-9 9h4l-3 7 9-9z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;
    &lt;strong&gt;Important: &lt;/strong&gt;The subplots on the left and on the right are &lt;strong&gt;very&lt;/strong&gt; different! Also note, that you can adjust the latency in the models plotted on the right (higher values for $\sigma$ implying less latency). The models on the left, however, are not capable of modeling latency (and thus incubation time). This underlines the importance of extending the link found by Rizoiu et al. to other compartmental models.
&lt;/div&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Hawkes-Processes&quot;&gt;Hawkes Processes&lt;a class=&quot;anchor-link&quot; href=&quot;#Hawkes-Processes&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;A Hawkes process is a type of counting process. A counting process counts events. These events can, for example, be infections (in epidemiology) or earthquakes (in seismology). Whenever an event occurs, the counting process experiences a jump of size $1$. Let's have a look at a sample path of a Hawkes process $N_t$ in the following figure (the blue line).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/blog/images/copied_from_nb/./fig/hawkes_sample_path_with_conditional_intensity.svg&quot; alt=&quot;Hawkes process - sample path and corresponding conditional intensity&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;You will notice that its jumps are not evenly distributed over the observed time interval $[0, 60]$. Why is that?&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;It's because the behavior of $N_t$ is dictated by its so-called conditional intensity $\lambda_t$ (the orange line). Whenever $\lambda_t$ is high we have a high probability of events. A low $\lambda_t$, on the other hand, leads to fewer jumps in $N_t$. This property is valid for all counting processes.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;What makes Hawkes processes so special is that their conditional intensity $\lambda_t$ again depends on the counting process. In the figure above we see that the jumps in $N_t$ also increase the conditional intensity.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;In general, the conditional intensity of a Hawkes process has the form
\begin{align}
\lambda_t
= \mu(t) + \sum\limits_{t_j &amp;lt; t} \nu(t-t_j)
,
\end{align}
where $t_j$ is an event time and $\mu(t)$ as well as $\nu(t-t_j)$ are both $\geq 0$.&lt;sup id=&quot;fnref-4&quot; class=&quot;footnote-ref&quot;&gt;&lt;a href=&quot;#fn-4&quot;&gt;4&lt;/a&gt;&lt;/sup&gt;
We call $\mu(t)$ the &lt;em&gt;background intensity&lt;/em&gt;. It is independent of $N_t$.&lt;/p&gt;
&lt;p&gt;$\nu(t - t_j)$, on the other hand, depends on $t_j$ and thus on the history of the counting process $N_t$. We call $\nu$ the &lt;em&gt;kernel&lt;/em&gt; of the Hawkes process.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;In the figure above, $\mu(t) = \mu$ was constant and $\nu$ was an exponential kernel, this means
\begin{align} \label{exphawkes}
\lambda_t
= \mu
+
\sum\limits_{t_j &amp;lt; t} \kappa \theta \text{e}^{-\theta (t - t_j)}.
\end{align}&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Here, $\kappa$ is called the &lt;em&gt;scale&lt;/em&gt; parameter and $\theta$ is called the &lt;em&gt;decay&lt;/em&gt; parameter. You may notice that this kernel equals the density of the exponential distribution with parameter $\theta$ scaled by the parameter $\kappa$.&lt;/p&gt;
&lt;p&gt;What is important is that the exponential kernel leads to immediate jumps in $\lambda_t$ when an event occurs. When modeling infections, this means that an infection immediately increases the probability of further infections. This also means, that there is no way of taking a latent period (which is similar to the incubation period&lt;sup id=&quot;fnref-5&quot; class=&quot;footnote-ref&quot;&gt;&lt;a href=&quot;#fn-5&quot;&gt;5&lt;/a&gt;&lt;/sup&gt;) into account. We will address this issue below. But first, let's head to the other class of models we discuss in this post.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Compartmental-Epidemic-Models&quot;&gt;Compartmental Epidemic Models&lt;a class=&quot;anchor-link&quot; href=&quot;#Compartmental-Epidemic-Models&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;The-SIR-Model&quot;&gt;The SIR Model&lt;a class=&quot;anchor-link&quot; href=&quot;#The-SIR-Model&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h4 id=&quot;Overview&quot;&gt;Overview&lt;a class=&quot;anchor-link&quot; href=&quot;#Overview&quot;&gt; &lt;/a&gt;&lt;/h4&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Compartmental epidemic models (such as SIR and SEIR) model the spread of a disease within some population of size $N$ by dividing this population into groups (so-called compartments). In the SIR model these groups are called&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;S (group of all &lt;em&gt;susceptibles&lt;/em&gt;),&lt;/li&gt;
&lt;li&gt;I (group of all &lt;em&gt;infected&lt;/em&gt;), and&lt;/li&gt;
&lt;li&gt;R (group of all &lt;em&gt;recovered&lt;/em&gt;).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Susceptibles are healthy. After becoming infected, they move to compartment I. After some time infected people recover from a disease and hence move to compartment R. The possible transitions between compartments are outlined in the following figure.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/blog/images/copied_from_nb/./fig/flowcharts/sir.svg&quot; alt=&quot;SIR model&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The exact laws that govern the rates at wich people transition from one compartment to the next can be expressed in various ways. In the so-called CTMC-SIR model this is achieved via stochastic differential equations. For brevity (and as they are not our main focus), we will not present them here.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Let $S_t$ be the number of people in compartment S at time $t$. We define $I_t$ and $R_t$ analogously. Now $S_t$, $I_t$, and $R_t$ are stochastic processes. Now we can establish a link between the SIR model and Hawkes processes by finding similarities in conditional intensities.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h4 id=&quot;The-link-to-Hawkes-processes&quot;&gt;The link to Hawkes processes&lt;a class=&quot;anchor-link&quot; href=&quot;#The-link-to-Hawkes-processes&quot;&gt; &lt;/a&gt;&lt;/h4&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;How does a conditional intensity look like in the SIR model? This depends on which process in this model we are considering. As we are interested in infections we might be tempted to choose the process $I_t$. However, $I_t$ is not a counting process, so we cannot compute a conditional intensity. (A counting process counts and thus, it is monotonically increasing, but $I_t$ decreases when people transition from I to R.)&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;We can solve this issue by choosing the process $I_t + R_t$. This represents a counting process, which counts all infections that have occurred until time $t$. Now it is possible to derive the conditional intensity $\lambda_t^{SIR}$ from the stochastic differential equations of the SIR model.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Unfortunately, the result is not directly comparable to the conditional intensity of a Hawkes process. This is because a Hawkes process can only model infections, whereas the SIR model also contains recoveries as events. Therefore, Rizoiu et al. calculated an expected value, integrating over the recovery times, which are not observable in the Hawkes process. If we call the set of all recovery times $\mathcal{T}$, then the main result of Rizoiu et al. is
\begin{align}
\mathbb{E}_{\mathcal{T}} \left(  \lambda_t^{SIR} \right)
= \left( 1 - \frac{I_t + R_t}{N} \right)
\sum\limits_{t_j &amp;lt; t} \beta \text{e}^{-\gamma (t - t_j)},
\end{align}
where $\beta$ and $\gamma$ are the parameters of the SIR model. (They also show up in the stochastic differential equations of the model.) $\beta$ is governing the rate at which infections take place, whereas $\gamma$ determines how fast people recover.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Now this looks pretty much like the conditional intensity of a Hawkes process with exponential kernel! To see this more easily, just set $\mu = 0$,
\begin{align}
\kappa \theta = \beta,
\end{align}
and
\begin{align}
\theta = \gamma
\end{align}
in equation $\eqref{exphawkes}$.
Now the only difference is the factor in front of the sum!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;To eliminate this last difference between the two models, Rizoiu et al. defined the HawkesN process. This process is defined by its conditional intensity, which is the same as that of a Hawkes process, but without the background intensity $\mu(t)$ and with the additional factor $(1-N_t/N)$, where $N_t$ denotes the HawkesN process at time $t$. So compared to a Hawkes process, the HawkesN process lacks the parameter $\mu(t)$, but features the additional parameter $N$, which can be interpreted as the population's size.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;This additional factor in the conditional intensity – let's call it HawkesN factor – has an important effect. As is the case with the Hawkes process, infections tend to increase the conditional intensity of the HawkesN process. However, as the number of events rises, this increasing effect declines for the HawkesN process and eventually, further events can even have a decreasing effect, since the factor in front of the sum decreases.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;With diseases we make similar observations. At first, infections increase the probability of further infections. However, as more and more people become infected, the number of susceptibles declines and this lowers the probability of further infections, as there are fewer people left who can become infected.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Using the link found by Rizoiu et al. we can translate an SIR model easily into a HawkesN process and vice versa using the equations above. This allows one, for example, to estimate model parameters in one model and then make predictions using the other model.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;The-SEIR-Model&quot;&gt;The SEIR Model&lt;a class=&quot;anchor-link&quot; href=&quot;#The-SEIR-Model&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The SEIR model is a generalization of the SIR model, adding a compartment between S and I. This compartment is called E, which stands for &lt;em&gt;exposed&lt;/em&gt;. Members of this group are infected, but are not able to infect others yet. After some time, people move on to compartment I, which means that they become infectious. The states and possible transitions are summarized in the following figure.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/blog/images/copied_from_nb/./fig/flowcharts/seir.svg&quot; alt=&quot;SEIR model&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The additional compartment allows for modeling a latent period – a key characteristic of many infectious diseases. The duration of the latent period – that is the time a person spends in compartment E – depends on the model parameter $\sigma$. The lower the value of $\sigma$, the longer the latent period. You can see this effect in the interactive chart at the top of this blog post; just move the slider for $\sigma$ and see what happens.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;We have found that the SEIR model also has a close relationship to the HawkesN process. However, for the expectation of the conditional intensity $\lambda_t^{SEIR}$ to match that of a HawkesN process, the kernel of the HawkesN process must not be the exponential kernel, but rather the &lt;em&gt;hypoexponential&lt;/em&gt; kernel or the &lt;em&gt;Erlang&lt;/em&gt; kernel. The conditional intensity with a hypoexponential kernel looks like
\begin{align}
\lambda_t
= \left(
    1 - \frac{N_t}{N}
  \right)
  \sum_{t_j &amp;lt; t}
    \kappa \frac{\theta \sigma}{\theta - \sigma}
    \left( 
      \text{e}^{-\sigma (t-t_j)} - \text{e}^{-\theta (t-t_j)}
    \right),
\end{align}
where everything that follows the scale parameter $\kappa$ is the density of a hypoexponential distribution.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;You may notice that this formula does not work for the case $\sigma = \theta$, as we would divide by zero. We have shown that in this case the link between SEIR and HawkesN is established with the Erlang kernel, which leads to the conditional intensity
\begin{align}
\lambda_t
= \left(
    1 - \frac{N_t}{N}
  \right)
  \sum_{t_j &amp;lt; t}
    \kappa \theta^2
    (t-t_j)
    \text{e}^{-\theta (t-t_j)}
.
\end{align}&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;How do these formulas differ from the conditional intensity with an exponential kernel? Have a look at the following chart. You can select a sequence of event times below the chart and the plot will update accordingly. To highlight the conditional intensity with a specific kernel, just click on the corresponding label in the legend. (To select multiple kernels, hold the shift key while clicking.)&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;

&lt;div id=&quot;altair-viz-5d9eef48d2044104a65149e449c95ff1&quot;&gt;&lt;/div&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
  (function(spec, embedOpt){
    let outputDiv = document.currentScript.previousElementSibling;
    if (outputDiv.id !== &quot;altair-viz-5d9eef48d2044104a65149e449c95ff1&quot;) {
      outputDiv = document.getElementById(&quot;altair-viz-5d9eef48d2044104a65149e449c95ff1&quot;);
    }
    const paths = {
      &quot;vega&quot;: &quot;https://cdn.jsdelivr.net/npm//vega@5?noext&quot;,
      &quot;vega-lib&quot;: &quot;https://cdn.jsdelivr.net/npm//vega-lib?noext&quot;,
      &quot;vega-lite&quot;: &quot;https://cdn.jsdelivr.net/npm//vega-lite@4.8.1?noext&quot;,
      &quot;vega-embed&quot;: &quot;https://cdn.jsdelivr.net/npm//vega-embed@6?noext&quot;,
    };

    function loadScript(lib) {
      return new Promise(function(resolve, reject) {
        var s = document.createElement('script');
        s.src = paths[lib];
        s.async = true;
        s.onload = () =&gt; resolve(paths[lib]);
        s.onerror = () =&gt; reject(`Error loading script: ${paths[lib]}`);
        document.getElementsByTagName(&quot;head&quot;)[0].appendChild(s);
      });
    }

    function showError(err) {
      outputDiv.innerHTML = `&lt;div class=&quot;error&quot; style=&quot;color:red;&quot;&gt;${err}&lt;/div&gt;`;
      throw err;
    }

    function displayChart(vegaEmbed) {
      vegaEmbed(outputDiv, spec, embedOpt)
        .catch(err =&gt; showError(`Javascript Error: ${err.message}&lt;br&gt;This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));
    }

    if(typeof define === &quot;function&quot; &amp;&amp; define.amd) {
      requirejs.config({paths});
      require([&quot;vega-embed&quot;], displayChart, err =&gt; showError(`Error loading script: ${err.message}`));
    } else if (typeof vegaEmbed === &quot;function&quot;) {
      displayChart(vegaEmbed);
    } else {
      loadScript(&quot;vega&quot;)
        .then(() =&gt; loadScript(&quot;vega-lite&quot;))
        .then(() =&gt; loadScript(&quot;vega-embed&quot;))
        .catch(showError)
        .then(() =&gt; displayChart(vegaEmbed));
    }
  })({&quot;config&quot;: {&quot;view&quot;: {&quot;continuousWidth&quot;: 400, &quot;continuousHeight&quot;: 300}}, &quot;data&quot;: {&quot;url&quot;: &quot;https://raw.githubusercontent.com/yogabonito/blog/master/_notebooks/fig/conditional_intensities.json&quot;}, &quot;mark&quot;: &quot;line&quot;, &quot;encoding&quot;: {&quot;color&quot;: {&quot;type&quot;: &quot;nominal&quot;, &quot;field&quot;: &quot;kernel&quot;}, &quot;opacity&quot;: {&quot;condition&quot;: {&quot;value&quot;: 1, &quot;selection&quot;: &quot;selector007&quot;}, &quot;value&quot;: 0.2}, &quot;tooltip&quot;: [{&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;t&quot;}, {&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;\u03bb\u209c&quot;}, {&quot;type&quot;: &quot;nominal&quot;, &quot;field&quot;: &quot;kernel&quot;}], &quot;x&quot;: {&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;t&quot;}, &quot;y&quot;: {&quot;type&quot;: &quot;quantitative&quot;, &quot;field&quot;: &quot;\u03bb\u209c&quot;, &quot;scale&quot;: {&quot;domain&quot;: [0, 3.5]}}}, &quot;selection&quot;: {&quot;selector007&quot;: {&quot;type&quot;: &quot;multi&quot;, &quot;fields&quot;: [&quot;kernel&quot;], &quot;bind&quot;: &quot;legend&quot;}, &quot;event Sequence&quot;: {&quot;type&quot;: &quot;single&quot;, &quot;fields&quot;: [&quot;event sequence&quot;], &quot;bind&quot;: {&quot;input&quot;: &quot;radio&quot;, &quot;options&quot;: [&quot;{0}  &quot;, &quot;{0, 1, 2}  &quot;, &quot;{0, 1, 2, ..., 9}  &quot;], &quot;name&quot;: &quot;Event times: &quot;}, &quot;init&quot;: {&quot;event sequence&quot;: &quot;{0, 1, 2}  &quot;}}}, &quot;transform&quot;: [{&quot;filter&quot;: {&quot;selection&quot;: &quot;event Sequence&quot;}}], &quot;$schema&quot;: &quot;https://vega.github.io/schema/vega-lite/v4.8.1.json&quot;}, {&quot;mode&quot;: &quot;vega-lite&quot;});
&lt;/script&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;We can see that a high value of the parameter $\sigma$ leads to a conditional intensity that resembles that with an exponential kernel. That is because the hypoexponential kernel converges to the exponential one – a property inherited from the densities of the hypoexponential and the exponential distribution:
\begin{align}
\lim_{\sigma \to \infty}
\frac{\theta \sigma}{\theta - \sigma}
    \left( 
      \text{e}^{-\sigma (t-t_j)} - \text{e}^{-\theta (t-t_j)}
    \right)
= \theta \text{e}^{-\theta (t - t_j)}.
\end{align}&lt;/p&gt;
&lt;p&gt;The same relationship exists between the SEIR model and the SIR model. When $\sigma$ goes to infinity, the time spent in compartment E goes to zero, thus eliminating the need for this compartment.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Now, let's have a look at smaller values of $\sigma$. They lead to a large delay with which the conditional intensity increases. In the SEIR model a lower $\sigma$ means that people spend more time in compartment E where they are not yet able to infect others. Thus, an infection does not immediately increase the probability of further infections but only does so with some delay.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;If we select the event sequence $\{0, 1, 2, \ldots, 9\}$ below the chart, we can see that the conditional intensity drops to zero at $t=9$. This is because in this example we assumed a population of only ten people. At $t=9$, the $10^{\text{th}}$ event occurs, so the factor $(1 - 10 / 10)$ in the conditional intensity of a HawkesN process becomes zero.&lt;/p&gt;
&lt;p&gt;In an S(E)IR model, this $10^{\text{th}}$ infection event has the same effect. As soon as everybody left the group of susceptibles, there is nobody left who can get infected.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The event sequence with ten events nicely reflects how infections can have an increasing effect on the conditional intensity at first. However, we can also see that the last two events decrease $\lambda_t$ – just as discussed above when we defined the HawkesN factor. Note that this decreasing effect eventually prevails irrespective of the kernel function used.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Summary-&amp;amp;-Discussion&quot;&gt;Summary &amp;amp; Discussion&lt;a class=&quot;anchor-link&quot; href=&quot;#Summary-&amp;amp;-Discussion&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;In this blog post we have briefly presented the link between the SEIR model and Hawkes processes, which can be seen as a generalization of Rizoiu et al.'s work. This means, that now this link can be used when modeling diseases that feature a latent period, during which infected people are not infectious.&lt;/p&gt;
&lt;p&gt;This, however, does not imply that the SEIR model is suitable for every disease and one has to keep in mind that the latent period is not necesserily the same as the incubation period&lt;sup id=&quot;fnref-5&quot; class=&quot;footnote-ref&quot;&gt;&lt;a href=&quot;#fn-5&quot;&gt;5&lt;/a&gt;&lt;/sup&gt;. This distinction is crucial for many diseases (e.g., Covid-19) and can complicate the the application of the SEIR model.&lt;/p&gt;
&lt;p&gt;Nonetheless, even in the case of Covid-19 there are works showing the application of the SEIR model. To this end, sometimes the model is adapted. One such adjustment can be the incorporation of quarantine measures.&lt;/p&gt;
&lt;p&gt;Further generalizations of the link between SEIR and HawkesN are possible and we will continue our research on this topic in order to offer tools related to Hawkes-processes to a wider range of compartmental epidemic models.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;References&quot;&gt;References&lt;a class=&quot;anchor-link&quot; href=&quot;#References&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;div class=&quot;footnotes&quot;&gt;&lt;p id=&quot;fn-1&quot;&gt;1. Hawkes (1971): &quot;Spectra of some self-exciting and mutually exciting point processes&quot;&lt;a href=&quot;#fnref-1&quot; class=&quot;footnote footnotes&quot;&gt;↩&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;&lt;div class=&quot;footnotes&quot;&gt;&lt;p id=&quot;fn-2&quot;&gt;2. Rizoiu et al. (2018): &quot;SIR-Hawkes: Linking Epidemic Models and Hawkes Processes to Model Diffusions in Finite Populations&quot;&lt;a href=&quot;#fnref-2&quot; class=&quot;footnote footnotes&quot;&gt;↩&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;&lt;div class=&quot;footnotes&quot;&gt;&lt;p id=&quot;fn-3&quot;&gt;3. &lt;a href=&quot;https://diglib.tugraz.at/download.php?id=5d4a774705898&amp;amp;location=aleph&quot;&gt;https://diglib.tugraz.at/download.php?id=5d4a774705898&amp;amp;location=aleph&lt;/a&gt;&lt;a href=&quot;#fnref-3&quot; class=&quot;footnote footnotes&quot;&gt;↩&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;&lt;div class=&quot;footnotes&quot;&gt;&lt;p id=&quot;fn-4&quot;&gt;4. &lt;a href=&quot;https://mathworld.wolfram.com/HawkesProcess.html&quot;&gt;https://mathworld.wolfram.com/HawkesProcess.html&lt;/a&gt;&lt;a href=&quot;#fnref-4&quot; class=&quot;footnote footnotes&quot;&gt;↩&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;&lt;/p&gt;
&lt;p&gt;&lt;div class=&quot;footnotes&quot;&gt;&lt;p id=&quot;fn-5&quot;&gt;5. &lt;a href=&quot;https://en.wikipedia.org/wiki/Incubation_period&quot;&gt;https://en.wikipedia.org/wiki/Incubation_period&lt;/a&gt;&lt;a href=&quot;#fnref-5&quot; class=&quot;footnote footnotes&quot;&gt;↩&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary></entry></feed>